<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTM Student Portal</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" type="image/x-icon" href="logo.png" />
    <script src="https://kit.fontawesome.com/3491f85d9f.js" crossorigin="anonymous"></script>
</head>

<style>
.post {
  border: 5px outset blue;
  background-color: white;    
  text-align: left;
  width: 1000px;
  padding: 25px;
  margin: 20px auto; /* Center the posts */
  color: black; /* Ensure text color is black for visibility */
  transition: width 0.4s, height 0.4s, transform 0.4s, box-shadow .3s;
}

.post:hover {
    transition: width 0.4s, height 0.4s, transform 0.4s;
    transform: translateY(-10px);
    box-shadow: 0 0 2px 4px rgb(27, 27, 255) 
}

/* Added styles for dark mode */
body.dark-mode {
  background-color: #242424;
  color: white; /* Ensure body text is white in dark mode */
}

body.dark-mode .post, body.dark-mode .new-post textarea, body.dark-mode .search-bar textarea{
  background-color: #333; /* Dark background for posts in dark mode */
  color: white; /* Ensure post text is white in dark mode */
}

.search-bar {
  display: flex;
  justify-content: center;
  margin: 20px;
  transition: box-shadow .3s;
}


.search-bar input[type="text"] {
  width: 300px;
  padding: 10px;
  margin-right: 10px;
  border-radius: 5px;
  border: 1px solid #ccc;
  transition: box-shadow .3s;
}

.search-bar textarea:hover{
    transition: box-shadow .3s;
    box-shadow: 0 0 4px 6px #D0D1C9; 
}

.search-bar button {
  padding: 10px;
  border-radius: 5px;
  background-color: blue;
  color: white;
  border: none;
  cursor: pointer;
}

.new-post {
  text-align: center;
  margin: 40px auto;
  width: 1000px;
}


.new-post input[type="text"], .new-post textarea {
  width: 60%;
  height: 200px;
  padding: 10px;
  margin: 10px 0;
  border-radius: 5px;
  border: 1px solid #ccc;
  transition: box-shadow .3s;
}

.new-post textarea:hover{
    transition: box-shadow .3s;
    box-shadow: 0 0 4px 6px #D0D1C9; 
}

.new-post button {
  height: 50px;
  padding: 10px 20px;
  border-radius: 5px;
  background-color: green;
  color: white;
  border: none;
  cursor: pointer;
  transition: width 0.4s, height 0.4s, transform 0.4s, box-shadow .3s;
}

.new-post button:hover {
    transition: width 0.4s, height 0.4s, transform 0.4s, box-shadow .3s;
    transform: translateY(-10px);
    box-shadow: 0 0 4px 9px #07ff24; 
}

.search-bar button:hover {
    transition: width 0.4s, height 0.4s, transform 0.4s, box-shadow .3s;
    transform: translateY(-10px);
    box-shadow: 0 0 4px 9px #070fff; 
}
</style>

<body>
    <!-- Header -->
    <header>
        <a href="index.html">
            <div class="logo-and-title">
                <img id="logo" src="logo.png" alt="Logo">
                <h1>Student Portal</h1>
            </div>
        </a>

         <!-- Dark Mode Toggle -->
         <div class="darkmode-toggle">
            <input type="checkbox" id="darkmode-toggle" onchange="toggleDarkMode()"/>
            <label for="darkmode-toggle">
                <!-- Sun SVG Icon -->
                <svg version="1.1" class="sun" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                    viewBox="0 0 496 496" style="enable-background:new 0 0 496 496;" xml:space="preserve">
                    <rect x="152.994" y="58.921" transform="matrix(0.3827 0.9239 -0.9239 0.3827 168.6176 -118.5145)" width="40.001" height="16"/>
                    <rect x="46.9" y="164.979" transform="matrix(0.9239 0.3827 -0.3827 0.9239 71.29 -12.4346)" width="40.001" height="16"/>
                    <rect x="46.947" y="315.048" transform="matrix(0.9239 -0.3827 0.3827 0.9239 -118.531 50.2116)" width="40.001" height="16"/>
                    <rect x="164.966" y="409.112" transform="matrix(-0.9238 -0.3828 0.3828 -0.9238 168.4872 891.7491)" width="16" height="39.999"/>
                    <rect x="303.031" y="421.036" transform="matrix(-0.3827 -0.9239 0.9239 -0.3827 50.2758 891.6655)" width="40.001" height="16"/>
                    <rect x="409.088" y="315.018" transform="matrix(-0.9239 -0.3827 0.3827 -0.9239 701.898 785.6559)" width="40.001" height="16"/>
                    <rect x="409.054" y="165.011" transform="matrix(-0.9239 0.3827 -0.3827 -0.9239 891.6585 168.6574)" width="40.001" height="16"/>
                    <rect x="315.001" y="46.895" transform="matrix(0.9238 0.3828 -0.3828 0.9238 50.212 -118.5529)" width="16" height="39.999"/>
                    <path d="M248,88c-88.224,0-160,71.776-160,160s71.776,160,160,160s160-71.776,160-160S336.224,88,248,88z M248,392
                        c-79.4,0-144-64.6-144-144s64.6-144,144-144s144,64.6,144,144S327.4,392,248,392z"/>
                    <rect x="240" width="16" height="72"/>
                    <rect x="62.097" y="90.096" transform="matrix(0.7071 0.7071 -0.7071 0.7071 98.0963 -40.6334)" width="71.999" height="16"/>
                    <rect y="240" width="72" height="16"/>
                    <rect x="90.091" y="361.915" transform="matrix(-0.7071 -0.7071 0.7071 -0.7071 -113.9157 748.643)" width="16" height="71.999"/>
                    <rect x="240" y="424" width="16" height="72"/>
                    <rect x="361.881" y="389.915" transform="matrix(-0.7071 -0.7071 0.7071 -0.7071 397.8562 960.6281)" width="71.999" height="16"/>
                    <rect x="424" y="240" width="72" height="16"/>
                    <rect x="389.911" y="62.091" transform="matrix(0.7071 0.7071 -0.7071 0.7071 185.9067 -252.6357)" width="16" height="71.999"/>
                </svg>
         
                <!-- Moon SVG Icon -->
                <svg version="1.1" class="moon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                    viewBox="0 0 49.739 49.739" style="enable-background:new 0 0 49.739 49.739;" xml:space="preserve">
                    <path d="M25.068,48.889c-9.173,0-18.017-5.06-22.396-13.804C-3.373,23.008,1.164,8.467,13.003,1.979l2.061-1.129l-0.615,2.268
                    c-1.479,5.459-0.899,11.25,1.633,16.306c2.75,5.493,7.476,9.587,13.305,11.526c5.831,1.939,12.065,1.492,17.559-1.258v0
                    c0.25-0.125,0.492-0.258,0.734-0.391l2.061-1.13l-0.585,2.252c-1.863,6.873-6.577,12.639-12.933,15.822
                    C32.639,48.039,28.825,48.888,25.068,48.889z M12.002,4.936c-9.413,6.428-12.756,18.837-7.54,29.253
                    c5.678,11.34,19.522,15.945,30.864,10.268c5.154-2.582,9.136-7.012,11.181-12.357c-5.632,2.427-11.882,2.702-17.752,0.748
                    c-6.337-2.108-11.473-6.557-14.463-12.528C11.899,15.541,11.11,10.16,12.002,4.936z"/>
                </svg>
            </label>
        </div>
    </header>
        <!-- New Post Form -->
    <div class="new-post">
        <h2>Create a New Post</h2>
        <p style="color: red;">You must enter all fields: title, message, (tags), otherwise you can not post!.</p>
        <textarea id="new-post-content" placeholder="Post title on the first line here. Example: This is a title!&#10;Main message on the second line. Example: This is my message!&#10;Tags on the last line. Example: (CCT286) (Tags always last)!"></textarea>
        <button onclick="createPost()">Post</button>
    </div>

    <!-- Enhanced Search Bar -->
    <div class="search-bar" style="display: block;"> <!-- Ensured the search bar is always displayed -->
        <p style="color: red;">Press search when empty to see all posts again!</p>
        <textarea id="search-tags" placeholder="Search for post...e.g. title, message,or (tag)"></textarea>
        <button onclick="filterPostsByTag()">Search</button>
    </div>

    <!-- Posts will be dynamically inserted here -->
    <div id="posts-container">
        <!-- Existing posts will be fetched and displayed here -->
        <div class="post" data-tags="(CSC209) (Lecture)">
            <h1>Recent CSC209 Notes</h1>
            <p>Does anyone have notes on the prof's writing from the most recent lecture? I missed the last few slides.</p>
            <p style="font-size: 80%">Tags: (CSC209) (Lecture)</p>
        </div>
    
        <div class="post" data-tags="(CCT386) (Definitions)">
            <h1>CCT386 Notes</h1>
            <p>Here's a link to some of the definitions from class. Feel free to comment if I missed any.</p>
            <p style="font-size: 80%">Tags: (CCT386) (Definitions)</p>
        </div>
    
        <div class="post" data-tags="(CCT109) (Lecture)">
            <h1>CCT109 Lecture Summary</h1>
            <p>Had to miss yesterday's lecture. I went through the slide deck but could anyone summarize what the lecture covered?</p>
            <p style="font-size: 80%">Tags: (CCT109) (Lecture)</p>
        </div>
    </div>


    <!-- JavaScript File -->
    <script src="main.js"></script>
    <script>
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        function filterPostsByTag() {
            const searchValue = document.getElementById('search-tags').value.toLowerCase().trim();
            const posts = document.querySelectorAll('.post');
            if (searchValue === '') {
                // If search is cleared, display all posts again
                posts.forEach(post => post.style.display = 'block');
            } else {
                updatePostVisibility(posts, searchValue);
            }
            // Clear search field after searching
            document.getElementById('search-tags').value = '';
        }

        function updatePostVisibility(posts, searchValue) {
            posts.forEach(post => {
                const tags = post.getAttribute('data-tags').toLowerCase();
                const title = post.querySelector('h1').textContent.toLowerCase();
                const message = post.querySelector('p').textContent.toLowerCase();
                // Split tags into an array and check if any tag exactly matches or contains the search value
                const tagMatches = tags.match(/\((.*?)\)/g);
                const tagArray = tagMatches ? tagMatches.map(tag => tag.toLowerCase()) : [];
                const isExactMatch = tagArray.includes(`(${searchValue})`);
                const isSimilarMatch = tagArray.some(tag => tag.includes(searchValue));
                const isTitleMatch = title.includes(searchValue);
                const isMessageMatch = message.includes(searchValue);
                // Display post if there's an exact match in tags, or if title/message contains the search value
                post.style.display = (isExactMatch || isSimilarMatch || isTitleMatch || isMessageMatch) ? 'block' : 'none';
            });
        }

        function createPost() {
            const content = document.getElementById('new-post-content').value;
            const postsContainer = document.getElementById('posts-container');

            const lines = content.split('\n');
            if (lines.length < 3) {
                alert("Please ensure you have entered a title, message, and tags before posting.");
                return; // Ensure there are at least 3 lines: title, content, tags
            }

            const title = lines[0];
            const message = lines.slice(1, -1).join('<br>'); // Join all lines except the first and last as the main message
            const tags = lines[lines.length - 1];

            const postElement = document.createElement('div');
            postElement.classList.add('post');
            postElement.setAttribute('data-tags', tags); // Ensure tags are added as a data attribute for searching
            postElement.innerHTML = `<h1>${title}</h1><p>${message}</p><p style="font-size: 80%">Tags: ${tags}</p>`; // Format the post with title, message, and tags

            postsContainer.appendChild(postElement);

            // Clear input field after posting
            document.getElementById('new-post-content').value = '';

            // Reapply the current filter to ensure consistency with the search criteria
            filterPostsByTag();
        }
    </script>
    <!-- Footer -->
    <footer class="iframe-footer">
        <div class="social-icons">
            <a href="https://www.instagram.com/uoftmississauga/?hl=en" target="_blank"><i class="fa-brands fa-instagram"></i></a>
            <a href="https://www.facebook.com/UTMississauga/" target="_blank"><i class="fa-brands fa-facebook"></i></a>
            <a href="https://www.reddit.com/r/UTM/" target="_blank"><i class="fa-brands fa-reddit"></i></a>
            <a href="https://twitter.com/UTM" target="_blank"><i class="fa-brands fa-twitter"></i></a>
            <a href="https://www.youtube.com/@utm/videos" target="_blank"><i class="fa-brands fa-youtube"></i></a>
        </div>
    </footer>
</body>
</html>

